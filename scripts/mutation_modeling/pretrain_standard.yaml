---
apiVersion: v1
kind: Pod
metadata:
  name: sfr-standard-protein-psturmfels
  namespace: sfr-ns-psturmfels
spec:
  restartPolicy: OnFailure
  volumes:
    - name: sfr-home-pv-psturmfels
      persistentVolumeClaim:
        claimName: sfr-home-pvc-psturmfels
    - name: sfr-share-pv-psturmfels
      persistentVolumeClaim:
        claimName: sfr-share-pvc-psturmfels
  containers:
    - name: psturmfels-default-gpu
      image: "gcr.io/salesforce-research-internal/psturmfels-default"
      command: ["/bin/bash", "-c", "cd /export/home/tape/ && python run_distributed.py  transformer masked_language_modeling --nproc_per_node 4"]
      resources:
        limits:
          cpu: "4"
          memory: "30Gi"
          nvidia.com/gpu: 4
      volumeMounts:
        - name: sfr-home-pv-psturmfels
          mountPath: "/export/home"
        - name: sfr-share-pv-psturmfels
          mountPath: "/export/share"
  nodeSelector:
    cloud.google.com/gke-accelerator: nvidia-tesla-v100
  tolerations:
  - key: "gpu_num"
    operator: "Equal"
    value: "8"
    effect: "NoSchedule"
